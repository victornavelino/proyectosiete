{% extends 'admin/change_form.html' %}
{% load i18n admin_urls static admin_modify %}
{% block footer  %}
<script type="text/javascript">
    // django.jQuery = jQuery;
     jQuery(document).ready(function () {
        console.log('funciona')

        // al seleccionar Empleado seteamos su ID
        jQuery('#id_origen').on('change', function () {
            let id_origen;
            jQuery("#id_origen option:selected").each(function () {
                id_origen = jQuery(this).val();
                });
            
            if (id_origen) {
                console.log('entro metodo')
                //hacer aqui la consulta
                let url_mask = "{% url 'get_articulos_deposito' id_deposito=1234567 %}".replace(/1234567/, id_origen);

                jQuery.ajax({
                    type: 'GET',
                    url: url_mask,
                    success: function (data) {
                        console.log('entro en la respuesta del backend')
                        console.log(data.error)
                        if (data.resultado) {

                               jQuery.each(data, function (key, registro) {
                                    jQuery("#id_articulo").append('<option value=' + registro.codigo + '>' + registro.codigo+' - '+ registro.articulo + '</option>');
                                });

                        }

                    },
                    error: function (response) {
                        console.log(response);
                    }

                });
                            }

        });

     });
 </script>
 <!-- SWEETALERT -->
    <script type="text/javascript" src="{% static 'js/sweetalert.min.js' %}"></script>
 {% endblock %}